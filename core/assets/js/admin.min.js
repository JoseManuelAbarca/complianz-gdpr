jQuery(document).ready(function(e){"use strict";function i(){e(".cmplz-validate-multicheckbox").each(function(i){var t=[],c=!0;e(this).find(":checkbox").each(function(i){t.push(e(this)),e(this).is(":checked")&&(c=!1)});var n=e(this).closest(".field-group").find(".cmplz-label");c?(n.removeClass("valid-multicheckbox"),n.addClass("invalid-multicheckbox"),e.each(t,function(e,i){i.prop("required",!0),i.addClass("is-required")})):(n.removeClass("invalid-multicheckbox"),n.addClass("valid-multicheckbox"),e.each(t,function(e,i){i.prop("required",!1),i.removeClass("is-required")}))}),c()}function t(){e(".cmplz-validate-radio").each(function(i){var t=[],c=!0;e(this).find("input:radio").each(function(i){t.push(e(this)),e(this).is(":checked")&&(c=!1)});var n=e(this).closest(".field-group").find(".cmplz-label");c?(n.removeClass("valid-radio"),n.addClass("invalid-radio")):(n.removeClass("invalid-radio"),n.addClass("valid-radio"))}),c()}function c(){var i,t=!0;e(".condition-check").each(function(c){var n="cmplz_"+e(this).data("condition-question"),a="AND";if(void 0!=n){var o=e(this).data("condition-answer"),s=e(this).find("input[type=checkbox]");s.length||(s=e(this).find("input")),s.length||(s=e(this).find("textarea")),s.length||(s=e(this).find("select")),s.length&&s[0].hasAttribute("required")&&s.addClass("is-required"),-1!==(o+="").indexOf("NOT ")?(o=o.replace("NOT ",""),t=!1):t=!0;var r=[];-1!==o.indexOf(" OR ")?(r=o.split(" OR "),a="OR"):r=[o];var l=e(this),d=!1;r.forEach(function(c){if(i=function(i){{if("text"==e("input[name^="+i+"]").attr("type"))return e("input[name^="+i+"]").val();var t=[];return e("input[name^="+i+"]:checked").each(function(){t[t.length]=e(this).val()}),t}}(n),e("select[name="+n+"]").length&&(i=Array(e("select[name="+n+"]").val())),e("input[name='"+n+"["+c+"]']").length&&(e("input[name='"+n+"["+c+"]']").is(":checked")?(d=!0,i=[]):(d=!1,i=[])),t){if(d||-1!=i.indexOf(c)||i==c)l.removeClass("hidden"),s.hasClass("is-required")&&s.prop("required",!0),"OR"===a&&(d=!0);else if(l.addClass("hidden"),s.hasClass("is-required")&&s.prop("required",!1),"OR"===a)return}else d||-1!=i.indexOf(c)||i==c?(l.addClass("hidden"),s.hasClass("is-required")&&s.prop("required",!1)):(l.removeClass("hidden"),s.hasClass("is-required")&&s.prop("required",!0))})}})}e(".cmplz-color-picker").wpColorPicker({change:function(i,t){var c=e(i.target).data("hidden-input");e("#"+c).val(t.color.toString())}}),e("#cmplz-support-form.hidden").hide().removeClass("hidden"),e(document).on("click","#cmplz-support-link",function(i){i.preventDefault();var t=e("#cmplz-support-form");t.is(":visible")?t.slideUp():t.slideDown()}),i(),e(".cmplz-validate-multicheckbox .is-required:checkbox").change(i),t(),e("input:radio").attr("required",!0).click(t),c(),e("input").change(function(e){c()}),e("select").change(function(e){c()}),e("textarea").change(function(e){c()});var n=1e3,a=complianz_admin.progress,o=e(".cmplz-progress-bar"),s=e(".detected-cookies");e("#cmplz_cookie_scan_frame").length&&function i(){var t=document.getElementById("cmplz_cookie_scan_frame");t.contentDocument||t.contentWindow.document;!s.find(".cmplz-loader").length&&a<100&&(s.html('<div class="cmplz-loader"><div class="rect1"></div><div class="rect2"></div><div class="rect3"></div><div class="rect4"></div><div class="rect5"></div></div>'),s.addClass("loader")),t.onload=function(){a>=100||e.get(complianz_admin.admin_url,{action:"cmplz_get_scan_progress"},function(t){var c;if(t){c=jQuery.parseJSON(t),a=parseInt(c.progress);var s=c.next_page;a>=100?(a=100,o.css({width:a+"%"}),e.ajax({type:"GET",url:complianz_admin.admin_url,dataType:"json",data:{action:"load_detected_cookies"},success:function(i){i.success&&(e(".detected-cookies").html(i.cookies),e(".detected-cookies.loader").removeClass("loader"))}})):(o.css({width:a+"%"}),e("#cmplz_cookie_scan_frame").attr("src",s),window.setTimeout(i,n))}})},window.setTimeout(i,n)}(),o.css({width:a+"%"}),e(document).on("click",".cmplz-add-to-policy",function(){var i=e(this).closest(".cmplz-custom-privacy-text-container").find(".cmplz-custom-privacy-header").html(),t=e(this).closest(".cmplz-custom-privacy-text-container").find(".cmplz-custom-privacy-text").html();!function(e,i,t){void 0===i&&(i=wpActiveEditor);void 0===t&&(t=i);jQuery("#wp-"+i+"-wrap").hasClass("tmce-active")&&tinyMCE.get(i)?tinyMCE.get(i).setContent(e):jQuery("#"+t).val(e)}(function(e,i){void 0===e&&(e=wpActiveEditor);void 0===i&&(i=e);return jQuery("#wp-"+e+"-wrap").hasClass("tmce-active")&&tinyMCE.get(e)?tinyMCE.get(e).getContent():jQuery("#"+i).val()}("cmplz_custom_privacy_policy_text")+"<h3>"+i+"</h3>"+t,"cmplz_custom_privacy_policy_text")}),window.setTimeout(function(){e(".cmplz-notice.cmplz-success").fadeTo(500,0).slideUp(500,function(){e(this).remove()})},2e3);var r="#bar_pct_all_container";e(r).show(),e(document).on("change","select[name=cmplz_region]",function(){e(r).hide();var i=e("select[name=cmplz_region]").val(),t=e("select[name=stats_type]").val();e(r="#bar_"+t+"_"+i+"_container").fadeIn()}),e(document).on("change","select[name=stats_type]",function(){e(r).hide();var i="eu";e("select[name=cmplz_region]").length&&(i=e("select[name=cmplz_region]").val());var t=e("select[name=stats_type]").val();e(r="#bar_"+t+"_"+i+"_container").fadeIn()}),e(document).on("click","#cmplz-report-unknown-cookies",function(){console.log(complianz_admin.admin_url),e.ajax({type:"POST",url:complianz_admin.admin_url,dataType:"json",data:{action:"cmplz_report_unknown_cookies"},success:function(i){console.log(i),i.success&&(e("#cmplz-report-unknown-cookies").hide(),e("#cmplz-report-confirmation").show())}})})});