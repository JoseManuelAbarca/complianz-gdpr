jQuery(document).ready(function(e){"use strict";function i(){e(".cmplz-validate-multicheckbox").each(function(i){var t=[],n=!0;e(this).find(":checkbox").each(function(i){t.push(e(this)),e(this).is(":checked")&&(n=!1)});var c=e(this).closest(".field-group").find(".cmplz-label");n?(c.removeClass("valid-multicheckbox"),c.addClass("invalid-multicheckbox"),e.each(t,function(e,i){i.prop("required",!0),i.addClass("is-required")})):(c.removeClass("invalid-multicheckbox"),c.addClass("valid-multicheckbox"),e.each(t,function(e,i){i.prop("required",!1),i.removeClass("is-required")}))}),n()}function t(){e(".cmplz-validate-radio").each(function(i){var t=[],n=!0;e(this).find("input:radio").each(function(i){t.push(e(this)),e(this).is(":checked")&&(n=!1)});var c=e(this).closest(".field-group").find(".cmplz-label");n?(c.removeClass("valid-radio"),c.addClass("invalid-radio")):(c.removeClass("invalid-radio"),c.addClass("valid-radio"))}),n()}function n(){var i,t=!0;e(".condition-check").each(function(n){var c="cmplz_"+e(this).data("condition-question"),a="AND";if(void 0!=c){var o=e(this).data("condition-answer"),s=e(this).find("input[type=checkbox]");s.length||(s=e(this).find("input")),s.length||(s=e(this).find("textarea")),s.length||(s=e(this).find("select")),s.length&&s[0].hasAttribute("required")&&s.addClass("is-required"),-1!==(o+="").indexOf("NOT ")?(o=o.replace("NOT ",""),t=!1):t=!0;var r=[];-1!==o.indexOf(" OR ")?(r=o.split(" OR "),a="OR"):r=[o];var l=e(this),d=!1;r.forEach(function(n){if(i=function(i){{if("text"==e("input[name^="+i+"]").attr("type"))return e("input[name^="+i+"]").val();var t=[];return e("input[name^="+i+"]:checked").each(function(){t[t.length]=e(this).val()}),t}}(c),e("select[name="+c+"]").length&&(i=Array(e("select[name="+c+"]").val())),e("input[name='"+c+"["+n+"]']").length&&(e("input[name='"+c+"["+n+"]']").is(":checked")?(d=!0,i=[]):(d=!1,i=[])),t){if(d||-1!=i.indexOf(n)||i==n)l.removeClass("hidden"),s.hasClass("is-required")&&s.prop("required",!0),"OR"===a&&(d=!0);else if(l.addClass("hidden"),s.hasClass("is-required")&&s.prop("required",!1),"OR"===a)return}else d||-1!=i.indexOf(n)||i==n?(l.addClass("hidden"),s.hasClass("is-required")&&s.prop("required",!1)):(l.removeClass("hidden"),s.hasClass("is-required")&&s.prop("required",!0))})}})}e(document).on("click",".cmplz-toggle-plugin-policy",function(){var i=e(this).closest(".cmplz-custom-privacy-text-container").find(".cmplz-custom-privacy-text"),t=e(this).closest(".cmplz-custom-privacy-text-container").find("i"),n=e(this).closest(".cmplz-custom-privacy-text-container").find(".cmplz-privacy-toggle-expl");i.is(":hidden")?(t.removeClass("fa-chevron-down"),t.addClass("fa-chevron-up"),n.hide(),i.slideDown("slow")):(i.slideUp("normal",function(){n.show()}),t.removeClass("fa-chevron-up"),t.addClass("fa-chevron-down"))}),e(".cmplz-color-picker").wpColorPicker({change:function(i,t){var n=e(i.target).data("hidden-input");e("#"+n).val(t.color.toString())}}),e("#cmplz-support-form.hidden").hide().removeClass("hidden"),e(document).on("click","#cmplz-support-link",function(i){i.preventDefault();var t=e("#cmplz-support-form");t.is(":visible")?t.slideUp():t.slideDown()}),i(),e(".cmplz-validate-multicheckbox .is-required:checkbox").change(i),t(),e("input:radio").attr("required",!0).click(t),n(),e("input").change(function(e){n()}),e("select").change(function(e){n()}),e("textarea").change(function(e){n()});var c=4e3,a=complianz_admin.progress,o=e(".cmplz-progress-bar"),s=e(".detected-cookies");e("#cmplz_cookie_scan_frame").length&&function i(){var t=document.getElementById("cmplz_cookie_scan_frame");t.contentDocument||t.contentWindow.document;!s.find(".cmplz-loader").length&&a<100&&(s.html('<div class="cmplz-loader"><div class="rect1"></div><div class="rect2"></div><div class="rect3"></div><div class="rect4"></div><div class="rect5"></div></div>'),s.addClass("loader")),t.onload=function(){a>=100||e.get(complianz_admin.admin_url,{action:"cmplz_get_scan_progress"},function(t){var n;if(t){n=jQuery.parseJSON(t),a=parseInt(n.progress);var s=n.next_page;a>=100?(a=100,o.css({width:a+"%"}),e.ajax({type:"GET",url:complianz_admin.admin_url,dataType:"json",data:{action:"load_detected_cookies"},success:function(i){i.success&&(e(".detected-cookies").html(i.cookies),e(".detected-cookies.loader").removeClass("loader"))}})):(o.css({width:a+"%"}),e("#cmplz_cookie_scan_frame").attr("src",s),window.setTimeout(i,c))}})},window.setTimeout(i,c)}(),o.css({width:a+"%"}),e(document).on("click",".cmplz-add-to-policy",function(){var i=e(this).closest(".cmplz-custom-privacy-text-container").find(".cmplz-custom-privacy-header").html(),t=e(this).closest(".cmplz-custom-privacy-text-container").find(".cmplz-custom-privacy-text").html();!function(e,i,t){void 0===i&&(i=wpActiveEditor);void 0===t&&(t=i);jQuery("#wp-"+i+"-wrap").hasClass("tmce-active")&&tinyMCE.get(i)?tinyMCE.get(i).setContent(e):jQuery("#"+t).val(e)}(function(e,i){void 0===e&&(e=wpActiveEditor);void 0===i&&(i=e);return jQuery("#wp-"+e+"-wrap").hasClass("tmce-active")&&tinyMCE.get(e)?tinyMCE.get(e).getContent():jQuery("#"+i).val()}("cmplz_custom_privacy_policy_text")+"<h3>"+i+"</h3>"+t,"cmplz_custom_privacy_policy_text")}),window.setTimeout(function(){e(".cmplz-notice.cmplz-hide").fadeTo(500,0).slideUp(500,function(){e(this).remove()})},2e3);var r="#bar_pct_all_container";e(r).show(),e(document).on("change","select[name=cmplz_region]",function(){e(r).hide();var i=e("select[name=cmplz_region]").val(),t=e("select[name=stats_type]").val();e(r="#bar_"+t+"_"+i+"_container").fadeIn()}),e(document).on("change","select[name=stats_type]",function(){e(r).hide();var i="eu";e("select[name=cmplz_region]").length&&(i=e("select[name=cmplz_region]").val());var t=e("select[name=stats_type]").val();e(r="#bar_"+t+"_"+i+"_container").fadeIn()}),e(document).on("click","#cmplz-report-unknown-cookies",function(){e.ajax({type:"POST",url:complianz_admin.admin_url,dataType:"json",data:{action:"cmplz_report_unknown_cookies"},success:function(i){console.log(i),i.success&&(e("#cmplz-report-unknown-cookies").hide(),e("#cmplz-report-confirmation").show())}})}),function(){if(e("#cmplz_anonymous_window_warning").length){var i=window.RequestFileSystem||window.webkitRequestFileSystem;if(!i)return;i(window.TEMPORARY,100,function(e){},function(i){e("#cmplz_anonymous_window_warning").show()})}e("#cmplz_adblock_warning").length&&void 0===window.canRunAds&&e("#cmplz_adblock_warning").show()}()});